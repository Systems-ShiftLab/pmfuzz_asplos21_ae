<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Fri Dec  4 12:15:23 2020 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PMFuzz</title>

</head>
<body>

<h1 align="center">PMFuzz</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#INPUT DIRECTORY">INPUT DIRECTORY</a><br>
<a href="#OUTPUT DIRECTORY">OUTPUT DIRECTORY</a><br>
<a href="#CONFIGURATION FILES">CONFIGURATION FILES</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#DISTRIBUTION">DISTRIBUTION</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">PMFuzz</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>PMFuzz</b>
[-h] [--force-resp FORCE_RESP] [--cores-stage1 CORES_STAGE1]
[--cores-stage2 CORES_STAGE2] [--overwrite]
[--disable-stage2] [--dry-run] [--progress-interval
PROGRESS_INTERVAL] [--progress-file PROGRESS_FILE]
[--checks-only] [--verbose] [--version] indir outdir
config</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">PMFuzz: A
Persistent Memory Fuzzer, version 1.0 by authors</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>indir</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">path to directory containing
initial test corpus for stage 1. See
<i>INPUT-DIRECTORY</i>.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>outdir</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>path to directory for generated test cases for stage 1,
works as input for stage 2. See <i>OUTPUT-DIRECTORY</i>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>config</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Points to the config file to use, should conform to:
configs/default.yaml. See <i>CONFIGURATION-FILE</i>.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>--force-resp</b>
<i>FORCE_RESP</i></p>

<p style="margin-left:22%;">Forces response to
questions</p>

<p style="margin-left:11%;"><b>--cores-stage1</b>
<i>CORES_STAGE1</i>, <b>-c1</b> <i>CORES_STAGE1</i></p>

<p style="margin-left:22%;">Maximum cores stage 1 fuzzer
can use, default: 1. Can be specified in config.</p>

<p style="margin-left:11%;"><b>--cores-stage2</b>
<i>CORES_STAGE2</i>, <b>-c2</b> <i>CORES_STAGE2</i></p>

<p style="margin-left:22%;">Maximum cores stage 2 fuzzer
can use, default: 1. Can be specified in config.</p>

<p style="margin-left:11%;"><b>--overwrite</b>,
<b>-o</b></p>

<p style="margin-left:22%;">Overwrite the output
directory</p>

<p style="margin-left:11%;"><b>--disable-stage2</b>,
<b>-1</b></p>

<p style="margin-left:22%;">Disables stage 2. Can be
specified in config.</p>

<p style="margin-left:11%;"><b>--dry-run</b></p>

<p style="margin-left:22%;">Enables dry run, no actual
commands are executed (Deprecated)</p>

<p style="margin-left:11%;"><b>--progress-interval</b>
<i>PROGRESS_INTERVAL</i></p>

<p style="margin-left:22%;">Interval in seconds for
recording progress, default: 60 seconds. Can be specified in
config.</p>

<p style="margin-left:11%;"><b>--progress-file</b>
<i>PROGRESS_FILE</i></p>

<p style="margin-left:22%;">Output file for writing
progress to a file. Can be specified in config.</p>

<p style="margin-left:11%;"><b>--checks-only</b></p>

<p style="margin-left:22%;">Performs startup checks and
exits</p>

<p style="margin-left:11%;"><b>--verbose</b>, <b>-v</b></p>

<p style="margin-left:22%;">Enables verbose logging to
stdout</p>

<p style="margin-left:11%;"><b>--version</b></p>

<p style="margin-left:22%;">show program&rsquo;s version
number and exit</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To run PMFuzz
without any additional output:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="20%">


<p>pmfuzz-fuzz \</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:17%;">./input_directory
./output_directory ./configs/default.yml</p>

<p style="margin-left:11%; margin-top: 1em">To record
fuzzing progress, use:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="20%">


<p>pmfuzz-fuzz \</p></td>
<td width="63%">
</td></tr>
</table>


<p style="margin-left:17%;">--progress-file=/tmp/fuzz_progress
<br>
./input_directory ./output_directory
./configs/default.yml</p>

<p style="margin-left:11%; margin-top: 1em">To get verbose
output of the PMFuzz&acute;s current step, use:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="20%">


<p>pmfuzz-fuzz \</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:17%;">--verbose \ <br>
./input_directory ./output_directory
./configs/default.yml</p>

<h2>INPUT DIRECTORY
<a name="INPUT DIRECTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">TODO</p>

<h2>OUTPUT DIRECTORY
<a name="OUTPUT DIRECTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">TODO</p>

<h2>CONFIGURATION FILES
<a name="CONFIGURATION FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">PMFuzz uses a
YAML based file to configure different parameters.</p>


<p style="margin-left:11%; margin-top: 1em"><b>configs/examples</b>
directory contains several examples for writing and
organizing configurations that PMFuzz can use. If you want
to write your own configuration file, include
<b>config/default.yml</b> in your new config file and change
the values you need.</p>

<p style="margin-left:11%; margin-top: 1em">If you are
writing your own configuration, please note the
following:</p>

<p style="margin-left:11%; margin-top: 1em"><b>Including
Other Configs</b> <br>
PMFuzz supports including one or more configuration files to
allow easier customization.</p>

<p style="margin-left:11%; margin-top: 1em">Syntax for
including config files is:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="12%">


<p>include:</p></td>
<td width="71%">
</td></tr>
</table>

<p style="margin-left:17%;">- base-config-1.yaml <br>
- base-config-2.yaml <br>
. <br>
. <br>
- base-config-n.yaml</p>

<p style="margin-left:11%; margin-top: 1em">In case of
duplicate keys, values are prioritized (and overwritten) in
the order they appear. However, the file including them have
highest priority.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Note</b>
<br>
Nested includes are not supported.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Variable
Substitution</b> <br>
The following variables are automatically substituted in the
config file values:</p>

<p style="margin-left:11%; margin-top: 1em"><b>%ROOT%</b>
<br>
Points to the PMFuzz root directory (root of this
repository)</p>

<p style="margin-left:11%; margin-top: 1em"><b>%BUILD%</b>
<br>
Points to the %ROOT%/build/</p>

<p style="margin-left:11%; margin-top: 1em"><b>%LIB%</b>
<br>
Points to the %ROOT%/build/lib</p>

<p style="margin-left:11%; margin-top: 1em"><b>%BIN%</b>
<br>
Points to the %ROOT%/build/bin</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example</b>
<br>
Here is a simple example that runs PMDK&acute;s RBTree
workload in baseline mode. This configuration overwrites the
number of CPU cores used by the first stage to 4. Note,
lines starting with <b>#</b> are comments.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="12%">


<p># Brief:</p></td>
<td width="71%">
</td></tr>
</table>

<p style="margin-left:17%;"># Runs the Baseline for
rbtree</p>

<p style="margin-left:17%; margin-top: 1em">include: <br>
- configs/base.yml <br>
- configs/workload/mapcli.rbtree.yml <br>
- configs/run_configs/baseline.yml</p>

<p style="margin-left:17%; margin-top: 1em">pmfuzz: <br>
stage: <br>
&quot;1&quot;: <br>
cores: 4</p>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This section
defines several environment variables that may change
PMFuzz&acute;s behavior.</p>

<p style="margin-left:11%; margin-top: 1em">Values
<b>set</b> and <b>unset</b> describe the behavior when the
environment variable is not set to any value and when the
variable is set to any non-empty string (including <b>0</b>)
respectively.</p>


<p style="margin-left:11%; margin-top: 1em"><b>USE_FAKE_MMAP
<br>
1</b> <br>
Enables fake mmap by copying the contents (using
<b>memcpy</b>) of the pool image to the volatile memory.
Mounting the pool to the volatile memory improves fuzzing
performance.</p>

<p style="margin-left:11%; margin-top: 1em"><b>0</b> <br>
Mounts the pool using PMDK&acute;s default mounting
functions. Before invoking the target, PMFuzz would create a
copy of the pool image and call the target on that image.
Depending on the output of the fuzzing,PMFuzz would either
save that image for future use, or discard it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>PMEM_MMAP_HINT
<br>
addr</b> <br>
Address of the mount point of the pool. See libpmem(7).</p>

<p style="margin-left:11%; margin-top: 1em"><b>unset</b>
<br>
PMDK decides the mount address of the pool.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ENABLE_CNST_IMG
<br>
1</b> <br>
Disables default PMDK&acute;s behaviour that generates
non-identical images for same input. <b><br>
0</b> <br>
PMFuzz generated images would have random variations that
may negatively affect the fuzzing performance and
reproducibility.</p>

<p style="margin-left:11%; margin-top: 1em"><b>FI_MODE <br>
&quot;IMG_GEN&quot;</b> <br>
In case the the PMFUZZ_MODE env variable is set to
&quot;IMG_GEN&quot;, a failure point is injected and the PM
Image is dumped if the PM pool has changed since the last
failure injection. First failure injection always results in
an image dump.</p>

<p style="margin-left:11%; margin-top: 1em">Images dump
naming pattern: <b>&lt;pool file name&gt;.&lt;failure
id&gt;</b> If a failure list file is additionally specified
using the env variable, the falure ids that generate dumps
are written to that file, one per line.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&quot;IMG_REP&quot;</b>
<br>
Todo</p>

<p style="margin-left:11%; margin-top: 1em">For more
information on FI_MODE see libpmfuzz.c.</p>


<p style="margin-left:11%; margin-top: 1em"><b>FAILURE_LIST</b>
<br>
Path to a file that libpmfuzz would write the failure IDs
to.</p>

<p style="margin-left:11%; margin-top: 1em">See
libpmfuzz.c</p>


<p style="margin-left:11%; margin-top: 1em"><b>PMFUZZ_DEBUG
<br>
1</b> <br>
Enables debug output from libpmfuzz.</p>

<p style="margin-left:11%; margin-top: 1em"><b>0 <br>
unset</b> <br>
Disables debug output from libpmfuzz.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ENABLE_PM_PATH</b>
<br>
Enables deep paths in PMFuzz</p>


<p style="margin-left:11%; margin-top: 1em"><b>GEN_ALL_CS</b>
<br>
TODO</p>


<p style="margin-left:11%; margin-top: 1em"><b>IMG_CREAT_FINJ</b>
<br>
TODO</p>


<p style="margin-left:11%; margin-top: 1em"><b>PMFUZZ_SKIP_TC_CHECK
<br>
set</b> <br>
Disable testcase size check in AFL++.</p>

<p style="margin-left:11%; margin-top: 1em"><b>unset</b>
<br>
Enables AFL++&acute;s default behaviour to check testcase
size.</p>

<p style="margin-left:11%; margin-top: 1em">See
afl-fuzz(1).</p>


<p style="margin-left:11%; margin-top: 1em"><b>PRIMITIVE_BASELINE_MODE
<br>
set</b> <br>
Makes workload delete image on start if the pool exists</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Report bugs at:
https://github.com/sihangliu/pmfuzz/issues</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>PMFuzz</b>
was written by ShiftLab. Contact:
&lt;suyash12mahar@outlook.com&gt;.</p>

<h2>DISTRIBUTION
<a name="DISTRIBUTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The latest
version of PMFuzz may be downloaded from
<a href="https://pagure.io/myproject">https://pagure.io/myproject</a></p>
<hr>
</body>
</html>
